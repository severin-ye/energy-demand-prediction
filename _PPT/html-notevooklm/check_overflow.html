<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é¡µé¢æº¢å‡ºæ£€æµ‹å·¥å…·</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      background: #1f2937;
      color: white;
      font-family: monospace;
      padding: 20px;
    }
    .report {
      background: #111827;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .page-status {
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
    }
    .ok { background: #065f46; }
    .warning { background: #92400e; }
    .error { background: #991b1b; }
    .metrics {
      font-size: 12px;
      color: #9ca3af;
      margin-left: 20px;
    }
  </style>
</head>
<body>
  <h1>ğŸ“ PPTé¡µé¢æº¢å‡ºæ£€æµ‹æŠ¥å‘Š</h1>
  <div id="report"></div>
  <div id="summary"></div>

  <script>
    const MAX_CONTENT_HEIGHT = 6.0 * 96; // 6.0in * 96dpi = 576px
    const PAGES = [
      '1-cover-intro.html',
      '2-research-background.html',
      '3-core-contributions.html',
      '4-method-overview.html',
      '5-prediction-model-architecture.html',
      '6-feature-discretization.html',
      '7-structure-learning-bn.html',
      '8-dlp-semantic-interpretation.html',
      '9-experimental-setup.html',
      '10-results-uci-prediction.html',
      '11-results-consistency-analysis.html',
      '12-case-study-peak-warning.html',
      '13-ablation-study.html',
      '14-replication-summary.html',
      '15-core-problem-performance.html',
      '16-implementation-details.html',
      '17-solutions-attempted.html',
      '18-future-work-overview.html',
      '19-system-architecture.html',
      '20-technical-innovations.html'
    ];

    async function checkPage(filename) {
      const iframe = document.createElement('iframe');
      iframe.style.width = '10in';
      iframe.style.height = '7.5in';
      iframe.style.position = 'absolute';
      iframe.style.left = '-9999px';
      iframe.src = filename;
      
      document.body.appendChild(iframe);
      
      return new Promise((resolve) => {
        iframe.onload = () => {
          try {
            const doc = iframe.contentDocument;
            const content = doc.querySelector('.content');
            const safe = doc.querySelector('.safe');
            
            if (!content) {
              resolve({ filename, error: 'æ‰¾ä¸åˆ° .content å…ƒç´ ' });
              return;
            }
            
            const contentHeight = content.scrollHeight;
            const safeHeight = safe ? safe.scrollHeight : 0;
            const overflow = contentHeight - MAX_CONTENT_HEIGHT;
            const percentage = ((contentHeight / MAX_CONTENT_HEIGHT) * 100).toFixed(1);
            
            resolve({
              filename,
              contentHeight: contentHeight.toFixed(1),
              safeHeight: safeHeight.toFixed(1),
              maxAllowed: MAX_CONTENT_HEIGHT.toFixed(1),
              overflow: overflow.toFixed(1),
              percentage,
              status: overflow > 0 ? 'overflow' : (overflow > -50 ? 'warning' : 'ok')
            });
            
            document.body.removeChild(iframe);
          } catch (e) {
            resolve({ filename, error: e.message });
            document.body.removeChild(iframe);
          }
        };
      });
    }

    async function checkAllPages() {
      const reportDiv = document.getElementById('report');
      const summaryDiv = document.getElementById('summary');
      
      reportDiv.innerHTML = '<div class="report"><h2>ğŸ” æ­£åœ¨æ£€æµ‹æ‰€æœ‰é¡µé¢...</h2></div>';
      
      const results = [];
      for (const page of PAGES) {
        const result = await checkPage(page);
        results.push(result);
        
        const status = result.error ? 'error' : result.status;
        const statusClass = status === 'ok' ? 'ok' : (status === 'warning' ? 'warning' : 'error');
        const statusIcon = status === 'ok' ? 'âœ…' : (status === 'warning' ? 'âš ï¸' : 'âŒ');
        
        const pageDiv = document.createElement('div');
        pageDiv.className = `page-status ${statusClass}`;
        
        if (result.error) {
          pageDiv.innerHTML = `${statusIcon} <strong>${result.filename}</strong> - ERROR: ${result.error}`;
        } else {
          pageDiv.innerHTML = `
            ${statusIcon} <strong>${result.filename}</strong>
            <div class="metrics">
              ğŸ“Š å†…å®¹é«˜åº¦: ${result.contentHeight}px / ${result.maxAllowed}px (${result.percentage}%)
              ${result.overflow > 0 ? `<br/>âš ï¸ <strong>è¶…å‡º: ${result.overflow}px</strong>` : ''}
              ${result.overflow < 0 ? `<br/>âœ“ å‰©ä½™: ${Math.abs(result.overflow).toFixed(1)}px` : ''}
            </div>
          `;
        }
        
        reportDiv.appendChild(pageDiv);
      }
      
      // ç”Ÿæˆæ‘˜è¦
      const overflowPages = results.filter(r => !r.error && r.status === 'overflow');
      const warningPages = results.filter(r => !r.error && r.status === 'warning');
      const okPages = results.filter(r => !r.error && r.status === 'ok');
      
      summaryDiv.innerHTML = `
        <div class="report">
          <h2>ğŸ“‹ æ£€æµ‹æ±‡æ€»</h2>
          <div style="font-size: 18px; line-height: 2;">
            âŒ æº¢å‡ºé¡µé¢: <strong style="color: #ef4444;">${overflowPages.length}</strong> ä¸ª<br/>
            âš ï¸ è­¦å‘Šé¡µé¢: <strong style="color: #f59e0b;">${warningPages.length}</strong> ä¸ª<br/>
            âœ… æ­£å¸¸é¡µé¢: <strong style="color: #10b981;">${okPages.length}</strong> ä¸ª
          </div>
          ${overflowPages.length > 0 ? `
            <div style="margin-top: 20px; padding: 15px; background: #991b1b; border-radius: 4px;">
              <strong>éœ€è¦ä¿®å¤çš„é¡µé¢ï¼š</strong><br/>
              ${overflowPages.map(p => `â€¢ ${p.filename} (è¶…å‡º ${p.overflow}px)`).join('<br/>')}
            </div>
          ` : ''}
        </div>
      `;
    }

    checkAllPages();
  </script>
</body>
</html>
