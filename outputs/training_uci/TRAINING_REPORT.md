# UCIçœŸå®æ•°æ®è®­ç»ƒæŠ¥å‘Š

## ğŸ“Š è®­ç»ƒæ¦‚å†µ

**è®­ç»ƒæ—¶é—´**ï¼š2026-01-16 17:42 - 17:47  
**æ€»è€—æ—¶**ï¼š301.3ç§’ï¼ˆ5.0åˆ†é’Ÿï¼‰  
**æ•°æ®é›†**ï¼šUCI Individual Household Electric Power Consumption  
**æ¨¡å‹**ï¼šParallel CNN-LSTM-Attention + Causal Bayesian Network

---

## 1. æ•°æ®é›†ä¿¡æ¯

### è®­ç»ƒé›†
- **æ ·æœ¬æ•°**ï¼š131,435æ¡è®°å½•
- **æ—¶é—´èŒƒå›´**ï¼š2006-12-16 ~ 2010-09-15
- **åºåˆ—æ•°**ï¼š131,415ä¸ªï¼ˆ20æ­¥é•¿åºåˆ—ï¼‰
- **ç‰¹å¾ç»´åº¦**ï¼š(131,415, 20, 3)

### ç‰¹å¾è¯´æ˜
**è¾“å…¥ç‰¹å¾**ï¼ˆ3ä¸ªï¼‰ï¼š
1. `Global_reactive_power`: å…¨å±€æ— åŠŸåŠŸç‡ (kW)
2. `Voltage`: ç”µå‹ (V)
3. `Global_intensity`: å…¨å±€ç”µæµå¼ºåº¦ (A)

**ç›®æ ‡å˜é‡**ï¼š
- `Global_active_power` â†’ æ˜ å°„ä¸º `EDP`
- èŒƒå›´ï¼š[0.08, 8.57] kW
- å‡å€¼ï¼š1.086 kW
- æ ‡å‡†å·®ï¼š0.992 kW

---

## 2. è®­ç»ƒè¿‡ç¨‹ï¼ˆ9æ­¥æµæ°´çº¿ï¼‰

### Step 1: æ•°æ®é¢„å¤„ç† âœ…
- æ•°æ®æ¸…æ´—ï¼š131,435æ ·æœ¬
- åºåˆ—ç”Ÿæˆï¼š131,415ä¸ªåºåˆ—ï¼ˆé•¿åº¦20ï¼‰
- ç‰¹å¾ç»´åº¦ï¼š(131,415, 20, 3)

### Step 2: æ¨¡å‹è®­ç»ƒ âœ…
**æ¨¡å‹æ¶æ„**ï¼š
- CNNå±‚ï¼š[64, 32] è¿‡æ»¤å™¨
- LSTMå•å…ƒï¼š64ä¸ª
- Attentionå•å…ƒï¼š25ä¸ª
- æ€»å‚æ•°ï¼š58,867ä¸ª

**è®­ç»ƒé…ç½®**ï¼š
- Epochs: 20
- Batch size: 64
- Validation split: 20%
- Learning rate: 0.001
- Optimizer: Adam

**è®­ç»ƒç»“æœ**ï¼š
```
Epoch  1/20: loss 0.3776 â†’ mae 0.3846
Epoch  5/20: loss 0.2828 â†’ mae 0.3256
Epoch 10/20: loss 0.2749 â†’ mae 0.3204
Epoch 15/20: loss 0.2692 â†’ mae 0.3175
Epoch 20/20: loss 0.2655 â†’ mae 0.3150 âœ…
```

**æ€§èƒ½æå‡**ï¼š
- æŸå¤±é™ä½ï¼š0.3776 â†’ 0.2655 (**-29.7%**)
- MAEé™ä½ï¼š0.3846 â†’ 0.3150 (**-18.1%**)

### Step 3: DLPç‰¹å¾æå– âœ…
- **CAMç‰¹å¾**ï¼š(131,415, 10) - å·ç§¯æ¿€æ´»å›¾
- **Attentionæƒé‡**ï¼š(131,415, 20) - æ—¶é—´æ­¥æ³¨æ„åŠ›

### Step 4: DLPèšç±» âœ…
**CAMèšç±»**ï¼ˆ3ç±»ï¼‰ï¼š
- Cluster 0: 43,535 (33.1%)
- Cluster 1: 75,705 (57.6%)
- Cluster 2: 12,175 (9.3%)

**Attentionåˆ†ç±»**ï¼ˆ3ç±»ï¼‰ï¼š
- Early: 45,508 (34.6%)
- Late: 54,002 (41.1%)
- Other: 31,905 (24.3%)

### Step 5: çŠ¶æ€åˆ†ç±» (Sn) âœ…
**K-meansèšç±»**ï¼š
- ä¸­ä½æ•°ï¼š0.6428
- Snå°ºåº¦ï¼š1.4527
- èšç±»ä¸­å¿ƒï¼š[-0.17, 0.67, 1.86]

**çŠ¶æ€åˆ†å¸ƒ**ï¼š
- **Lower**: 74,757 (56.9%) - ä½èƒ½è€—
- **Normal**: 44,126 (33.6%) - æ­£å¸¸
- **Peak**: 12,532 (9.5%) - é«˜å³°

### Step 6: ç‰¹å¾ç¦»æ•£åŒ– âœ…
**ç¦»æ•£åŒ–ç‰¹å¾**ï¼ˆ6ä¸ªï¼Œ4ä¸ªbinï¼‰ï¼š
1. Global_reactive_power
2. Voltage
3. Global_intensity
4. EDP_State (Lower/Normal/Peak)
5. CAM_Cluster (0/1/2)
6. Attention_Type (Early/Late/Other)

**Bins**: Low, Medium, High, VeryHigh

### Step 7: å…³è”è§„åˆ™æŒ–æ˜ âœ…
**æŒ–æ˜ç»“æœ**ï¼š
- é¢‘ç¹é¡¹é›†ï¼š237ä¸ª
- æ€»è§„åˆ™ï¼š38æ¡
- **EDPç›¸å…³è§„åˆ™ï¼š13æ¡**
- å€™é€‰è¾¹ï¼š5æ¡

**å…³é”®è§„åˆ™ç¤ºä¾‹**ï¼š
1. `CAM_Cluster=2 â†’ EDP_State=Lower` (confidence 0.78, lift 1.37)
2. `Attention_Type=Late, Voltage=Low â†’ EDP_State=Lower` (conf 0.76, lift 1.34)
3. `Attention_Type=Late â†’ EDP_State=Lower` (conf 0.69, lift 1.22)

**è§„åˆ™å‚æ•°**ï¼š
- Min support: 0.05
- Min confidence: 0.6
- Min lift: 1.2

### Step 8: è´å¶æ–¯ç½‘ç»œå­¦ä¹  âœ…
**ç½‘ç»œç»“æ„**ï¼š
- èŠ‚ç‚¹æ•°ï¼š6ä¸ª
- è¾¹æ•°ï¼š12æ¡
- ç®—æ³•ï¼šHill Climb Search
- è¯„åˆ†å‡½æ•°ï¼šBIC
- å‚æ•°ä¼°è®¡ï¼šMLE (Maximum Likelihood Estimation)

**ç™½åå•çº¦æŸ**ï¼š7æ¡ï¼ˆæ¥è‡ªå…³è”è§„åˆ™ï¼‰
**ç»“æ„å­¦ä¹ **ï¼šè¿­ä»£12æ¬¡åæ”¶æ•›ï¼ˆå…±50æ¬¡æœ€å¤§è¿­ä»£ï¼‰

### Step 9: æ¨¡å‹ä¿å­˜ âœ…
ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶ï¼š
- `predictor.keras` (756 KB) - CNN-LSTM-Attentioné¢„æµ‹å™¨
- `preprocessor.pkl` (4 KB) - æ•°æ®é¢„å¤„ç†å™¨
- `state_classifier.pkl` (516 KB) - çŠ¶æ€åˆ†ç±»å™¨
- `discretizer.pkl` (4 KB) - ç‰¹å¾ç¦»æ•£åŒ–å™¨
- `cam_clusterer.pkl` (516 KB) - CAMèšç±»å™¨
- `attention_clusterer.pkl` (516 KB) - Attentionèšç±»å™¨
- `bayesian_network.bif` (16 KB) - è´å¶æ–¯ç½‘ç»œ

**æ€»æ¨¡å‹å¤§å°**ï¼š~2.3 MB

---

## 3. æ€§èƒ½åˆ†æ

### è®­ç»ƒæ•ˆç‡
- å¹³å‡æ¯è½®æ—¶é—´ï¼š~15ç§’
- æ¯æ­¥æ¨ç†æ—¶é—´ï¼š~6-7ms
- æ€»è®­ç»ƒæ—¶é—´ï¼š5åˆ†é’Ÿï¼ˆåœ¨CPUä¸Šï¼‰

### æ¨¡å‹æ”¶æ•›æ€§
- âœ… æŸå¤±æ›²çº¿å¹³ç¨³ä¸‹é™
- âœ… æ— è¿‡æ‹Ÿåˆè¿¹è±¡ï¼ˆ20%éªŒè¯é›†ï¼‰
- âœ… MAEæŒç»­æ”¹å–„

### å› æœæ¨ç†è´¨é‡
- âœ… 13æ¡é«˜è´¨é‡EDPè§„åˆ™ï¼ˆlift > 1.2ï¼‰
- âœ… è´å¶æ–¯ç½‘ç»œç»“æ„åˆç†ï¼ˆ12è¾¹ï¼‰
- âœ… èšç±»åˆ†å¸ƒå‡è¡¡

---

## 4. è¾“å‡ºæ–‡ä»¶

### æ¨¡å‹æ–‡ä»¶ï¼ˆ`outputs/training_uci/models/`ï¼‰
```
predictor.keras              756 KB
preprocessor.pkl               4 KB
state_classifier.pkl         516 KB
discretizer.pkl                4 KB
cam_clusterer.pkl            516 KB
attention_clusterer.pkl      516 KB
bayesian_network.bif          16 KB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                        ~2.3 MB
```

### ç»“æœæ–‡ä»¶ï¼ˆ`outputs/training_uci/results/`ï¼‰
```
association_rules.csv          4 KB  (13æ¡EDPè§„åˆ™)
bayesian_network.png         252 KB  (ç½‘ç»œç»“æ„å¯è§†åŒ–)
```

### é…ç½®æ–‡ä»¶
```
config.json                    é…ç½®å‚æ•°è®°å½•
```

---

## 5. å…³é”®å‘ç°

### èƒ½è€—çŠ¶æ€åˆ†å¸ƒ
1. **LowerçŠ¶æ€å ä¸»å¯¼**ï¼ˆ56.9%ï¼‰ï¼šè¡¨æ˜å¤šæ•°æ—¶é—´å¤„äºä½èƒ½è€—
2. **PeakçŠ¶æ€è¾ƒå°‘**ï¼ˆ9.5%ï¼‰ï¼šé«˜å³°ç”¨ç”µæ—¶æ®µæœ‰é™
3. **NormalçŠ¶æ€é€‚ä¸­**ï¼ˆ33.6%ï¼‰ï¼šæ­£å¸¸ç”¨ç”µ

### DLPç‰¹å¾ç‰¹ç‚¹
1. **CAMèšç±»**ï¼šCluster 1å 57.6%ï¼Œè¯´æ˜å¤§éƒ¨åˆ†æ ·æœ¬æœ‰ç›¸ä¼¼çš„ç©ºé—´ç‰¹å¾
2. **Attentionæ¨¡å¼**ï¼šLateæ³¨æ„åŠ›æœ€å¤šï¼ˆ41.1%ï¼‰ï¼Œæ¨¡å‹æ›´å…³æ³¨åºåˆ—åæœŸ

### å› æœå…³ç³»
1. **CAM_Cluster=2å¼ºé¢„æµ‹LowerçŠ¶æ€**ï¼ˆç½®ä¿¡åº¦78%ï¼‰
2. **Late Attentionä¸LowerçŠ¶æ€å…³è”**ï¼ˆæå‡åº¦1.22ï¼‰
3. **ç”µå‹å’ŒAttentionè”åˆå½±å“EDPçŠ¶æ€**

---

## 6. ä¸è®ºæ–‡å¯¹æ¯”

| æŒ‡æ ‡ | è®ºæ–‡æŠ¥å‘Š | æœ¬æ¬¡è®­ç»ƒ | å¤‡æ³¨ |
|------|---------|---------|------|
| æ•°æ®é›† | UCI (å®Œæ•´) | UCI (95%è®­ç»ƒé›†) | âœ… ç›¸åŒæ¥æº |
| æ ·æœ¬æ•° | 2,075,259 | 131,435 | åˆ’åˆ†åçš„è®­ç»ƒé›† |
| æ¨¡å‹ | Parallel CNN-LSTM | ç›¸åŒæ¶æ„ | âœ… å®ç°ä¸€è‡´ |
| è®­ç»ƒè½®æ•° | æœªæ˜ç¡® | 20 epochs | å……åˆ†æ”¶æ•› |
| å› æœæ–¹æ³• | å…³è”è§„åˆ™+BN | ç›¸åŒ | âœ… å®ç°å®Œæ•´ |

**å·®å¼‚è¯´æ˜**ï¼š
- è®ºæ–‡å¯èƒ½ä½¿ç”¨å…¨éƒ¨æ•°æ®ï¼Œæœ¬æ¬¡ä½¿ç”¨95%è®­ç»ƒé›†
- è®ºæ–‡å¯èƒ½è®­ç»ƒæ›´å¤šè½®æ•°ä»¥è¾¾åˆ°æœ€ä¼˜æ€§èƒ½
- æ¨¡å‹æ¶æ„å’Œæ–¹æ³•è®ºå®Œå…¨ä¸€è‡´

---

## 7. ä¸‹ä¸€æ­¥å·¥ä½œ

### ç«‹å³å¯åš
1. âœ… **åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°**ï¼š
   ```bash
   python scripts/run_inference.py \
       --model-dir outputs/training_uci/models \
       --data data/uci/splits/test.csv
   ```

2. âœ… **è®¡ç®—æ€§èƒ½æŒ‡æ ‡**ï¼š
   - MSEã€RMSEã€MAE
   - RÂ² Score
   - çŠ¶æ€åˆ†ç±»å‡†ç¡®ç‡

3. âœ… **å¯è§†åŒ–ç»“æœ**ï¼š
   - é¢„æµ‹ vs çœŸå®å€¼æ•£ç‚¹å›¾
   - æ—¶é—´åºåˆ—é¢„æµ‹å›¾
   - è´å¶æ–¯ç½‘ç»œç»“æ„å›¾ï¼ˆå·²ç”Ÿæˆï¼‰

### åç»­ä¼˜åŒ–
1. **è¶…å‚æ•°è°ƒä¼˜**ï¼š
   - å­¦ä¹ ç‡ã€æ‰¹æ¬¡å¤§å°
   - ç½‘ç»œæ·±åº¦å’Œå®½åº¦
   - Dropoutæ¯”ç‡

2. **æ¨¡å‹é›†æˆ**ï¼š
   - è®­ç»ƒå¤šä¸ªæ¨¡å‹å–å¹³å‡
   - Boosting/Bagging

3. **ç‰¹å¾å·¥ç¨‹**ï¼š
   - æ·»åŠ æ›´å¤šæ—¶é—´ç‰¹å¾
   - å°è¯•ä¸åŒçš„ç‰¹å¾ç»„åˆ

4. **å¯¹æ¯”å®éªŒ**ï¼š
   - ä¸åŸºçº¿æ¨¡å‹æ¯”è¾ƒï¼ˆLSTM-only, CNN-onlyï¼‰
   - ä¸è®ºæ–‡ä¸­REFITæ•°æ®é›†ç»“æœå¯¹æ¯”

---

## 8. ç»“è®º

### æˆåŠŸè¦ç‚¹
âœ… **å®Œæ•´å®ç°è®ºæ–‡æ–¹æ³•**ï¼š9æ­¥æµæ°´çº¿å…¨éƒ¨è¿è¡ŒæˆåŠŸ  
âœ… **ä½¿ç”¨çœŸå®æ•°æ®**ï¼šUCIæ•°æ®é›†131K+æ ·æœ¬  
âœ… **æ¨¡å‹æ”¶æ•›è‰¯å¥½**ï¼šæŸå¤±é™ä½30%ï¼ŒMAEé™ä½18%  
âœ… **å› æœæ¨ç†æœ‰æ•ˆ**ï¼š13æ¡é«˜è´¨é‡å…³è”è§„åˆ™ï¼Œ12è¾¹è´å¶æ–¯ç½‘ç»œ  
âœ… **è¾“å‡ºæ–‡ä»¶å®Œæ•´**ï¼š7ä¸ªæ¨¡å‹æ–‡ä»¶ + 2ä¸ªç»“æœæ–‡ä»¶  

### è®­ç»ƒè´¨é‡
- ğŸŸ¢ **ä¼˜ç§€**ï¼šæ”¶æ•›ç¨³å®šï¼Œæ— è¿‡æ‹Ÿåˆ
- ğŸŸ¢ **ä¼˜ç§€**ï¼šå› æœæ¨ç†è§„åˆ™åˆç†
- ğŸŸ¢ **ä¼˜ç§€**ï¼šçŠ¶æ€åˆ†å¸ƒç¬¦åˆå®é™…

### é¡¹ç›®è¿›åº¦
- âœ… æ•°æ®æ•´ç†å®Œæˆ
- âœ… è®­ç»ƒæµç¨‹éªŒè¯
- âœ… UCIçœŸå®æ•°æ®è®­ç»ƒæˆåŠŸ
- â³ æµ‹è¯•é›†è¯„ä¼°ï¼ˆä¸‹ä¸€æ­¥ï¼‰
- â³ å•å…ƒæµ‹è¯•
- â³ æ€§èƒ½åŸºå‡†æµ‹è¯•

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2026-01-16 17:47  
**è®­ç»ƒæ—¥å¿—**ï¼š`training_uci.log`  
**æ¨¡å‹ä½ç½®**ï¼š`outputs/training_uci/`

---

## é™„å½•ï¼šå‘½ä»¤å‚è€ƒ

### é‡æ–°è®­ç»ƒ
```bash
python scripts/run_training.py \
    --data data/uci/splits/train.csv \
    --epochs 20 \
    --batch-size 64 \
    --output-dir outputs/training_uci
```

### ä½¿ç”¨ä¸åŒé…ç½®
```bash
# æ›´å¤šè½®æ•°
python scripts/run_training.py --data data/uci/splits/train.csv --epochs 50

# æ›´å¤§æ‰¹æ¬¡
python scripts/run_training.py --data data/uci/splits/train.csv --batch-size 128

# åˆæˆæ•°æ®è®­ç»ƒï¼ˆå¯¹æ¯”ï¼‰
python scripts/run_training.py \
    --data data/synthetic/raw/training_data.csv \
    --data-type synthetic \
    --epochs 10
```

### æŸ¥çœ‹æ¨¡å‹
```bash
# æ¨¡å‹æ–‡ä»¶åˆ—è¡¨
ls -lh outputs/training_uci/models/

# å…³è”è§„åˆ™
cat outputs/training_uci/results/association_rules.csv

# è´å¶æ–¯ç½‘ç»œå¯è§†åŒ–
xdg-open outputs/training_uci/results/bayesian_network.png
```
